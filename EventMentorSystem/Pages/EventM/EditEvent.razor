@using EMS.DB.Models
@using EMS.DB.Constant
@using  EMS.DB.Repository.Interface
@inject IEventRepository _EventRepository;
@inject ISnackbar Snackbar;
<MudDialog>
    <DialogContent>
        <MudGrid>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.EventName" Class="m-0" Label="Event Name" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.OperatorName" Class="m-0" Label="Operator Name" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.EventVenue" Class="m-0" Label="EventVenue" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.OrganizerName" Class="m-0" Label="Organizer Name" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.OrganizerContact" Class="m-0" Label="Organizer Contact" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.Description" Class="m-0" Label="Description" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudSwitch @bind-Checked="eventModel.IsApproved" Class="m-0" Color="Color.Primary" Label="Approved?" />
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudSwitch @bind-Checked="eventModel.Ispaymentdone" Class="m-0" Color="Color.Primary" Label="Approved?" />
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudText Class="m-0">SlotType</MudText>
                <MudRadioGroup Class="m-0" @bind-SelectedOption="@eventModel.SlotType">
                    <MudRadio Option="@(EventSlotType.Morning.ToString())" Color="Color.Primary">@EventSlotType.Morning.ToString()</MudRadio>
                    <MudRadio Option="@(EventSlotType.Evening.ToString())" Color="Color.Primary">@EventSlotType.Evening.ToString()</MudRadio>
                    <MudRadio Option="@(EventSlotType.FullDay.ToString())" Color="Color.Primary">@EventSlotType.FullDay.ToString()</MudRadio>
                    <MudRadio Option="@(EventSlotType.MultipleDay.ToString())" Color="Color.Primary">@EventSlotType.MultipleDay.ToString()</MudRadio>
                </MudRadioGroup>
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudDatePicker Label="From Date" Class="m-0" Variant="Variant.Outlined" @bind-Date="eventModel.FromDate" DateFormat="dd.MM.yyyy" />
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudDatePicker Label="From Date" Class="m-0" @bind-Date="eventModel.Todate" DateFormat="dd.MM.yyyy" />
            </MudItem>
            <MudItem lg="4" md="4" xs="12">
                <MudTextField @bind-Value="eventModel.Description" Class="m-0" Label="Description" Variant="Variant.Outlined" Margin="Margin.Normal"></MudTextField>
            </MudItem>
        </MudGrid>
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Primary" OnClick="Save" Variant="Variant.Filled">Edit</MudButton>
    </DialogActions>
</MudDialog>



@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter] public Event eventModel { get; set; } = new Event();
    private bool isReadOnly = false;
    void Submit() => MudDialog.Close(DialogResult.Ok(true));
    void Cancel() => MudDialog.Cancel();

    protected override void OnInitialized()
    {
        if (eventModel is not null && eventModel.Id > 0)
        {
            isReadOnly = true;
        }

        base.OnInitialized();
    }
    private void Save()
    {
        try
        {
            _EventRepository.Insert(eventModel);
            MudDialog.Close(DialogResult.Ok(true));
            eventModel = new Event();

        }
        catch (Exception ex)
        {
            Snackbar.Add(ex.Message, Severity.Error);
        }

    }

}
